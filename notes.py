import numpy as np

reference = np.array([
    [16.35, "C_0"],
    [17.32, "C^#_0/D^b_0"],
    [18.35, "D_0"],
    [19.45, "D^#_0/E^b_0"],
    [20.60, "E_0"],
    [21.83, "F_0"],
    [23.12, "F^#_0/G^b_0"],
    [24.50, "G_0"],
    [25.96, "G^#_0/A^b_0"],
    [27.50, "A_0"],
    [29.14, "A^#_0/B^b_0"],
    [30.87, "B_0"],
    [32.70, "C_1"],
    [34.65, "C^#_1/D^b_1"],
    [36.71, "D_1"],
    [38.89, "D^#_1/E^b_1"],
    [41.20, "E_1"],
    [43.65, "F_1"],
    [46.25, "F^#_1/G^b_1"],
    [49.00, "G_1"],
    [51.91, "G^#_1/A^b_1"],
    [55.00, "A_1"],
    [58.27, "A^#_1/B^b_1"],
    [61.74, "B_1"],
    [65.41, "C_2"],
    [69.30, "C^#_2/D^b_2"],
    [73.42, "D_2"],
    [77.78, "D^#_2/E^b_2"],
    [82.41, "E_2"],
    [87.31, "F_2"],
    [92.50, "F^#_2/G^b_2"],
    [98.00, "G_2"],
    [103.83, "G^#_2/A^b_2"],
    [110.00, "A_2"],
    [116.54, "A^#_2/B^b_2"],
    [123.47, "B_2"],
    [130.81, "C_3"],
    [138.59, "C^#_3/D^b_3"],
    [146.83, "D_3"],
    [155.56, "D^#_3/E^b_3"],
    [164.81, "E_3"],
    [174.61, "F_3"],
    [185.00, "F^#_3/G^b_3"],
    [196.00, "G_3"],
    [207.65, "G^#_3/A^b_3"],
    [220.00, "A_3"],
    [233.08, "A^#_3/B^b_3"],
    [246.94, "B_3"],
    [261.63, "C_4"],
    [277.18, "C^#_4/D^b_4"],
    [293.66, "D_4"],
    [311.13, "D^#_4/E^b_4"],
    [329.63, "E_4"],
    [349.23, "F_4"],
    [369.99, "F^#_4/G^b_4"],
    [392.00, "G_4"],
    [415.30, "G^#_4/A^b_4"],
    [440.00, "A_4"],
    [466.16, "A^#_4/B^b_4"],
    [493.88, "B_4"],
    [523.25, "C_5"],
    [554.37, "C^#_5/D^b_5"],
    [587.33, "D_5"],
    [622.25, "D^#_5/E^b_5"],
    [659.25, "E_5"],
    [698.46, "F_5"],
    [739.99, "F^#_5/G^b_5"],
    [783.99, "G_5"],
    [830.61, "G^#_5/A^b_5"],
    [880.00, "A_5"],
    [932.33, "A^#_5/B^b_5"],
    [987.77, "B_5"],
    [1046.50, "C_6"],
    [1108.73, "C^#_6/D^b_6"],
    [1174.66, "D_6"],
    [1244.51, "D^#_6/E^b_6"],
    [1318.51, "E_6"],
    [1396.91, "F_6"],
    [1479.98, "F^#_6/G^b_6"],
    [1567.98, "G_6"],
    [1661.22, "G^#_6/A^b_6"],
    [1760.00, "A_6"],
    [1864.66, "A^#_6/B^b_6"],
    [1975.53, "B_6"],
    [2093.00, "C_7"],
    [2217.46, "C^#_7/D^b_7"],
    [2349.32, "D_7"],
    [2489.02, "D^#_7/E^b_7"],
    [2637.02, "E_7"],
    [2793.83, "F_7"],
    [2959.96, "F^#_7/G^b_7"],
    [3135.96, "G_7"],
    [3322.44, "G^#_7/A^b_7"],
    [3520.00, "A_7"],
    [3729.31, "A^#_7/B^b_7"],
    [3951.07, "B_7"],
    [4186.01, "C_8"],
    [4434.92, "C^#_8/D^b_8"],
    [4698.63, "D_8"],
    [4978.03, "D^#_8/E^b_8"],
    [5274.04, "E_8"],
    [5587.65, "F_8"],
    [5919.91, "F^#_8/G^b_8"],
    [6271.93, "G_8"],
    [6644.88, "G^#_8/A^b_8"],
    [7040.00, "A_8"],
    [7458.62, "A^#_8/B^b_8"],
    [7902.13, "B_8"],
])


def note_to_freq(note):
    i = reference[..., 1].tolist().index(note)
    return float(reference[i, 0])


def freq_to_note(freq):
    i = reference[..., 0].tolist().index(str(freq))
    return reference[i, 1]


def generate_sound_from_freq(freq, fs, duration):
    return np.sin(2 * np.pi * np.arange(fs * duration / 1000) * freq / fs)


def generate_sound_from_note(note, fs, duration):
    freq = note_to_freq(note)
    return generate_sound_from_freq(freq, fs, duration)


def generate_sound_from_notes(notes, fs, duration):
    return np.sum(generate_sound_from_note(note, fs, duration) for note in notes)


def frequencies():
    return reference[..., 0].astype(float)


def names():
    return reference[..., 1]


def frequencies_to_notes(frequencies):
    return [freq_to_note(f) for f in frequencies]
